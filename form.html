<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>javascript REGEX</title>
    <!-- bootstrap link -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container">
      <div class="row justufy-content-center">
        <div class="col-8">
          <h1 class="my-5">Expression Regex</h1>
        </div>
      </div>
    </div>

    <form action="" method="post" id="loginForm">
      <!-- email -->
      <div class="form-group">
        <label for="email" class="form-label">Email address</label>
        <input type="text" class="form-control" name="email" />
        <small></small>
      </div>
      <div class="form-group mb-5">
        <label for="pass" class="form-label">Password</label>
        <input type="text" class="form-control" name="pass" id="pass" />
      </div>
      <div class="form-group mt-9">
        <button type="submit" class="btn btn-secondary">
          Envoyer
        </button>
      </div>
    </form>

    <script>
      let form = document.querySelector("#loginForm");

      form.email.addEventListener("change", function () {
        validEmail(this);
      });

      const validEmail = function (inputEmail) {
        //creation du regex pour validation email
        let emailRegExp = new RegExp(
          "^[a-zA-Z0-9.-_]+[@]{1}[a-zA-Z0-9.-_]+[.]{1}[a-z]{2,10}$",
          "g"
        );

        // Recuperation du balise small
        let small = inputEmail.nextElementSibling;
        // test de Regexp
        if (emailRegExp.test(inputEmail.value)) {
          small.innerHTML = "Adresse Email Valide";
          small.classList.remove("text-danger");
          small.classList.add("text-success");
        } else {
          small.innerHTML = "Adresse Email Non Valide";
          small.classList.remove("text-success");
          small.classList.add("text-danger");
        }
      };

      const validPassword = function (inputPassword) {
        let msg;
        let valid = false;
        // Au moins 3 caracteres
        if (inputPassword.value.length < 3) {
          msg = "Le mot de passe doit contenir au moins 3 caracteres";
        }
        // Au moins 1 MAJ
        else if (!/[A-Z]/.test(inputPassword.value)) {
          msg = "Le mot de passe doit contenir au moins 1 majuscule";
        }
        // Au moins 1 min
        else if (!/[a-z]/.test(inputPassword.value)) {
          msg = "Le mot de passe doit contenir au moins 1 miniscule";
        }
        // Au moins 1 chiffre
        else if (!/[0-9]/.test(inputPassword.value)) {
          msg = "Le mot de passe doit contenir au moins 1 chiffre";
        }
        // Mot de passe Valid
        else {
          msg = "Le mot de passe est valide";
          valid = true;
        }
      };
      // Affichage
      // Recuperation du balise small
      let small = inputEmail.nextElementSibling;
        // test de Regexp
        if (valid) {
          small.innerHTML = "Mot de passe Valide";
          small.classList.remove("text-danger");
          small.classList.add("text-success");
        } else {
          small.innerHTML = msg;
          small.classList.remove("text-success");
          small.classList.add("text-danger");
        };
    </script>
  </body>
</html>
